<CourseFloatingBanner 
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/#fileId=https://huggingface.co/agents-course/notebooks/blob/main/fr/unit2/smolagents/tools.ipynb"},
]} 
askForHelpUrl="http://hf.co/join/discord" />

# Outils

Comme nous l'avons explor√© dans [l'Unit√© 1](https://huggingface.co/learn/agents-course/fr/unit1/introduction), les agents utilisent des outils pour effectuer diverses actions. Dans `smolagents`, les outils sont trait√©s comme des **fonctions qu'un *LLM* peut appeler au sein d'un syst√®me d'agent**.

Pour interagir avec un outil, le *LLM* a besoin d'une **description d'interface** avec ces composants cl√©s :

- **Nom** : Comment l'outil s'appelle
- **Description de l'outil** : Ce que fait l'outil
- **Types et descriptions des entr√©es** : Quels arguments l'outil accepte
- **Type de sortie** : Ce que l'outil retourne

Par exemple, pendant qu'il se pr√©pare pour une f√™te au manoir Wayne, Alfred a besoin de divers outils pour recueillir des informations : de la recherche de services de traiteur √† la recherche d'id√©es de th√®mes de f√™te. Voici √† quoi pourrait ressembler l'interface d'un simple outil de recherche :

- **Nom :** `web_search`
- **Description de l'outil :** Recherche sur le web des requ√™tes sp√©cifiques
- **Entr√©e :** `query` (string) - Le terme de recherche √† rechercher
- **Sortie :** String contenant les r√©sultats de recherche

En utilisant ces outils, Alfred peut prendre des d√©cisions √©clair√©es et rassembler toutes les informations n√©cessaires pour planifier la f√™te parfaite.

Ci-dessous, vous pouvez voir une animation illustrant comment un appel d'outil est g√©r√© :

![Pipeline agentique de https://huggingface.co/docs/smolagents/conceptual_guides/react](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/transformers/Agent_ManimCE.gif)

## M√©thodes de cr√©ation d'outils

Dans `smolagents`, les outils peuvent √™tre d√©finis de deux fa√ßons :
1. **En utilisant le d√©corateur `@tool`** pour des outils simples bas√©s sur des fonctions
2. **En cr√©ant une sous-classe de `Tool`** pour des fonctionnalit√©s plus complexes

### Le d√©corateur `@tool`

Le d√©corateur `@tool` est la **m√©thode recommand√©e pour d√©finir des outils simples**. Sous le capot, `smolagents` analysera les informations de base sur la fonction √† partir de Python. Donc si vous nommez votre fonction clairement et √©crivez une bonne *docstring*, il sera plus facile pour le *LLM* de l'utiliser.

En utilisant cette approche, nous d√©finissons une fonction avec :

- **Un nom de fonction clair et descriptif** qui aide le *LLM* √† comprendre son objectif.
- **Des indications de type pour les entr√©es et les sorties** pour assurer une utilisation correcte.
- **Une description d√©taill√©e**, incluant une section `Args:` o√π chaque argument est explicitement d√©crit. Ces descriptions fournissent un contexte pr√©cieux pour le *LLM*, il est donc important de les √©crire soigneusement.

#### G√©n√©rer un outil qui r√©cup√®re le service de traiteur le mieux not√©

<img src="https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit2/smolagents/alfred-catering.jpg" alt="Alfred Catering"/>

> [!TIP]
> Vous pouvez suivre le code dans <a href="https://huggingface.co/agents-course/notebooks/blob/main/fr/unit2/smolagents/tools.ipynb" target="_blank">ce <i>notebook</i></a> que vous pouvez ex√©cuter avec Google Colab.

Imaginons qu'Alfred ait d√©j√† d√©cid√© du menu pour la f√™te, mais qu'il ait maintenant besoin d'aide pour pr√©parer la nourriture pour un si grand nombre d'invit√©s. Pour ce faire, il aimerait engager un service de traiteur et doit identifier les options les mieux not√©es disponibles. Alfred peut utiliser un outil pour rechercher les meilleurs services de traiteur proche de chez lui.

Voici un exemple de la fa√ßon dont Alfred peut utiliser le d√©corateur `@tool` pour y parvenir :

```python
from smolagents import CodeAgent, InferenceClientModel, tool

# Supposons que nous ayons une fonction qui recherche les services de restauration les mieux not√©s
@tool
def catering_service_tool(query: str) -> str:
    """
    Cet outil retourne le service de traiteur le mieux not√© √† Gotham City.

    Args:
        query: Un terme de recherche pour trouver des services de traiteur.
    """
    # Exemple de liste de services de traiteur et leurs notes
    services = {
        "Gotham Catering Co.": 4.9,
        "Wayne Manor Catering": 4.8,
        "Gotham City Events": 4.7,
    }

    # Trouver le service de traiteur le mieux not√© (simulation du filtrage de requ√™te de recherche)
    best_service = max(services, key=services.get)

    return best_service


agent = CodeAgent(tools=[catering_service_tool], model=InferenceClientModel())

# Ex√©cuter l'agent pour trouver le meilleur service de traiteur
result = agent.run(
    "Can you give me the name of the highest-rated catering service in Gotham City?"
)

print(result)   # Sortie : Gotham Catering Co.
```

### D√©finir un outil comme une classe Python

Cette approche implique de cr√©er une sous-classe de [`Tool`](https://huggingface.co/docs/smolagents/v1.8.1/en/reference/tools#smolagents.Tool). Pour des outils complexes, nous pouvons impl√©menter une classe au lieu d'une fonction Python. La classe encapsule la fonction avec des m√©tadonn√©es qui aident le *LLM* √† comprendre comment l'utiliser efficacement. Dans cette classe, nous d√©finissons :

- `name` : Le nom de l'outil.
- `description` : Une description utilis√©e pour remplir le prompt syst√®me de l'agent.
- `inputs` : Un dictionnaire avec les cl√©s `type` et `description`, fournissant des informations pour aider l'interpr√©teur Python √† traiter les entr√©es.
- `output_type` : Sp√©cifie le type de sortie attendu.
- `forward` : La m√©thode contenant la logique d'inf√©rence √† ex√©cuter.

Ci-dessous, nous pouvons voir un exemple d'un outil construit en utilisant `Tool` et comment l'int√©grer dans un `CodeAgent`.

#### G√©n√©rer un outil pour g√©n√©rer des id√©es pour une f√™te sur le th√®me des super-h√©ros

La f√™te d'Alfred au manoir est un **√©v√©nement √† th√®me portant sur les super-h√©ros**, mais il a besoin d'id√©es cr√©atives pour la rendre vraiment sp√©ciale. En tant qu'h√¥te fantastique, il veut surprendre les invit√©s avec un th√®me unique.

Pour ce faire, il peut utiliser un agent qui g√©n√®re des id√©es de f√™tes sur le th√®me des super-h√©ros en fonction d'une cat√©gorie donn√©e. De cette fa√ßon, Alfred peut trouver le th√®me de f√™te parfait pour √©pater ses invit√©s.

```python
from smolagents import Tool, CodeAgent, InferenceClientModel

class SuperheroPartyThemeTool(Tool):
    name = "superhero_party_theme_generator"
    description = """
    Cet outil propose des id√©es de f√™tes cr√©atives sur le th√®me des super-h√©ros en fonction d'une cat√©gorie.
    Il retourne une id√©e de th√®me de f√™te unique."""

    inputs = {
        "category": {
            "type": "string",
            "description": "Le type de f√™te de super-h√©ros (par exemple, 'classic heroes', 'villain masquerade', 'futuristic Gotham').",
        }
    }

    output_type = "string"

    def forward(self, category: str):
        themes = {
            "classic heroes": "Justice League Gala : Les invit√©s viennent habill√©s en leurs h√©ros DC pr√©f√©r√©s avec des cocktails √† th√®me comme 'The Kryptonite Punch'.",
            "villain masquerade": "Gotham Rogues' Ball : Un bal masqu√© myst√©rieux o√π les invit√©s s'habillent en m√©chants classiques de Batman.",
            "futuristic Gotham": "Neo-Gotham Night : Une f√™te de style cyberpunk inspir√©e de Batman Beyond, avec des d√©corations n√©on et des gadgets futuristes."
        }

        return themes.get(category.lower(), "Id√©e de f√™te √† th√®me non trouv√©e. Essayez 'classic heroes', 'villain masquerade', ou 'futuristic Gotham'.")

# Instancier l'outil
party_theme_tool = SuperheroPartyThemeTool()
agent = CodeAgent(tools=[party_theme_tool], model=InferenceClientModel())

# Ex√©cuter l'agent pour g√©n√©rer une id√©e de th√®me de f√™te
result = agent.run(
    "What would be a good superhero party idea for a 'villain masquerade' theme?"
)

print(result)  # Sortie : "Gotham Rogues' Ball : Un bal masqu√© myst√©rieux o√π les invit√©s s'habillent en m√©chants classiques de Batman."
```

Avec cet outil, Alfred sera le super h√¥te par excellence, impressionnant ses invit√©s avec une f√™te sur le th√®me des super-h√©ros qu'ils n'oublieront pas ! ü¶∏‚Äç‚ôÇÔ∏èü¶∏‚Äç‚ôÄÔ∏è

## Bo√Æte √† outils par d√©faut

`smolagents` est livr√© avec un ensemble d'outils pr√©-construits qui peuvent √™tre directement inject√©s dans votre agent. La [bo√Æte √† outils par d√©faut](https://huggingface.co/docs/smolagents/guided_tour?build-a-tool=Decorate+a+function+with+%40tool#default-toolbox) comprend :

- **PythonInterpreterTool**
- **FinalAnswerTool**
- **UserInputTool**
- **DuckDuckGoSearchTool**
- **GoogleSearchTool**
- **VisitWebpageTool**

Alfred peut utiliser divers outils pour assurer une f√™te parfaite au manoir Wayne :

- D'abord, il pourrait utiliser le `DuckDuckGoSearchTool` pour trouver des id√©es cr√©atives de f√™te sur le th√®me des super-h√©ros.

- Pour le traiteur, il se fierait au `GoogleSearchTool` pour trouver les services les mieux not√©s √† Gotham.

- Pour g√©rer la disposition des tables, Alfred pourrait effectuer des calculs avec l'outil `PythonInterpreterTool`.

- Une fois que tout est rassembl√©, il compilerait le plan en utilisant  `FinalAnswerTool`.

Gr√¢ce √† ces outils, Alfred garantit que la f√™te sera √† la fois exceptionnelle et harmonieuse. ü¶áüí°

## Partage et importation d'outils

L'une des fonctionnalit√©s les plus puissantes de `smolagents` est sa capacit√© √† partager des outils personnalis√©s sur le Hub et √† int√©grer de mani√®re transparente des outils cr√©√©s par la communaut√©. Cela inclut la connexion avec les **Spaces** d'Hugging Face et les **outils LangChain**, am√©liorant consid√©rablement la capacit√© d'Alfred √† orchestrer une f√™te inoubliable. üé≠

Avec ces int√©grations, Alfred peut exploiter des outils avanc√©s de planification d'√©v√©nements ; qu'il s'agisse d'ajuster l'√©clairage pour l'ambiance parfaite, de cr√©er la *playlist* id√©ale pour la f√™te, ou de coordonner avec les meilleurs traiteurs de Gotham.

Voici des exemples montrant comment ces fonctionnalit√©s peuvent am√©liorer l'exp√©rience de la f√™te :

### Partager un outil sur le Hub

Partager votre outil personnalis√© avec la communaut√© est facile ! Il suffit de le t√©l√©charger sur votre compte Hugging Face en utilisant la m√©thode `push_to_hub()`.

Par exemple, Alfred peut partager son `party_theme_tool` pour aider les autres √† trouver les meilleurs services de traiteur √† Gotham. Voici comment faire :

```python
party_theme_tool.push_to_hub("{your_username}/party_theme_tool", token="<YOUR_HUGGINGFACEHUB_API_TOKEN>")
```

### Importer un outil depuis le Hub

Vous pouvez facilement importer des outils cr√©√©s par d'autres utilisateurs en utilisant la fonction `load_tool()`. Par exemple, Alfred pourrait vouloir g√©n√©rer une image promotionnelle pour la f√™te en utilisant l'IA. Au lieu de construire un outil √† partir de z√©ro, il peut exploiter un outil pr√©d√©fini de la communaut√© :

```python
from smolagents import load_tool, CodeAgent, InferenceClientModel

image_generation_tool = load_tool(
    "m-ric/text-to-image",
    trust_remote_code=True
)

agent = CodeAgent(
    tools=[image_generation_tool],
    model=InferenceClientModel()
)

agent.run("Generate an image of a luxurious superhero-themed party at Wayne Manor with made-up superheros.")
```

### Importer un Space comme outil

Vous pouvez √©galement importer un *Space* comme outil en utilisant `Tool.from_space()`. Cela ouvre des possibilit√©s d'int√©gration avec des milliers de *Spaces* de la communaut√© pour des t√¢ches allant de la g√©n√©ration d'images √† l'analyse de donn√©es.

L'outil se connectera au *backend Gradio* des *Spaces* en utilisant le `gradio_client`, alors assurez-vous de l'installer via `pip` si vous ne l'avez pas d√©j√† fait.

Pour la f√™te, Alfred peut utiliser un *Space* existant pour la g√©n√©ration de l'image g√©n√©r√©e par IA √† utiliser comme invitation (au lieu de l'outil pr√©-construit que nous avons mentionn√© pr√©c√©demment). Construisons-le !

```python
from smolagents import CodeAgent, InferenceClientModel, Tool

image_generation_tool = Tool.from_space(
    "black-forest-labs/FLUX.1-schnell",
    name="image_generator",
    description="Generate an image from a prompt"
)

model = InferenceClientModel("Qwen/Qwen2.5-Coder-32B-Instruct")

agent = CodeAgent(tools=[image_generation_tool], model=model)

agent.run(
    "Improve this prompt, then generate an image of it.",
    additional_args={'user_prompt': 'A grand superhero-themed party at Wayne Manor, with Alfred overseeing a luxurious gala'}
)
```

### Importer un outil LangChain

Nous discuterons du *framework* `LangChain` dans les sections √† venir. Pour l'instant, nous notons simplement que nous pouvons r√©utiliser des outils LangChain dans votre *workflow* `smolagents` !

Vous pouvez facilement charger des outils LangChain en utilisant la m√©thode `Tool.from_langchain()`. Alfred, toujours aussi perfectionniste, pr√©pare une spectaculaire soir√©e de super-h√©ros au manoir pendant l'absence des Wayne. Pour s'assurer que chaque d√©tail d√©passe les attentes, il utilise les outils LangChain pour trouver des id√©es de divertissement de premier ordre.

En utilisant `Tool.from_langchain()`, Alfred ajoute sans effort des fonctionnalit√©s de recherche avanc√©es √† son agent, lui permettant de d√©couvrir des id√©es et services de f√™te exclusifs avec seulement quelques commandes.

Voici comment il proc√®de :

```python
from langchain.agents import load_tools
from smolagents import CodeAgent, InferenceClientModel, Tool

search_tool = Tool.from_langchain(load_tools(["serpapi"])[0])

agent = CodeAgent(tools=[search_tool], model=model)

agent.run("Search for luxury entertainment ideas for a superhero-themed event, such as live performances and interactive experiences.")
```

### Importer une collection d'outils depuis n'importe quel serveur MCP

`smolagents` permet √©galement d'importer des outils depuis les centaines de serveurs MCP disponibles sur [glama.ai](https://glama.ai/mcp/servers) ou [smithery.ai](https://smithery.ai). Si vous voulez approfondir le MCP, vous pouvez consulter notre [cours gratuit](https://huggingface.co/learn/mcp-course/).

<details>
<summary>Installer le client mcp</summary>

Nous devons d'abord installer l'int√©gration `mcp` pour `smolagents`.

```bash
pip install "smolagents[mcp]"
```
</details>

Les outils des serveurs MCP peuvent √™tre charg√©s dans un objet `ToolCollection` comme suit :

```python
import os
from smolagents import ToolCollection, CodeAgent
from mcp import StdioServerParameters
from smolagents import InferenceClientModel


model = InferenceClientModel("Qwen/Qwen2.5-Coder-32B-Instruct")


server_parameters = StdioServerParameters(
    command="uvx",
    args=["--quiet", "pubmedmcp@0.1.3"],
    env={"UV_PYTHON": "3.12", **os.environ},
)

with ToolCollection.from_mcp(server_parameters, trust_remote_code=True) as tool_collection:
    agent = CodeAgent(tools=[*tool_collection.tools], model=model, add_base_tools=True)
    agent.run("Please find a remedy for hangover.")
```

Gr√¢ce √† cette configuration, Alfred peut rapidement d√©couvrir des options de divertissement luxueuses et s'assurer que les invit√©s de l'√©lite de Gotham vivent une exp√©rience inoubliable. Cet outil l'aide √† organiser l'√©v√©nement parfait sur le th√®me des super-h√©ros ! üéâ

## Ressources

- [Tutoriel sur les outils](https://huggingface.co/docs/smolagents/tutorials/tools) - Explorez ce tutoriel pour apprendre √† travailler efficacement avec les outils.
- [Documentation sur les outils](https://huggingface.co/docs/smolagents/v1.8.1/en/reference/tools) - Documentation de r√©f√©rence compl√®te sur les outils.
- [Visite guid√©e des outils](https://huggingface.co/docs/smolagents/v1.8.1/en/guided_tour#tools) - Une visite guid√©e √©tape par √©tape pour vous aider √† construire et utiliser efficacement les outils.
- [Construire des agents efficaces](https://huggingface.co/docs/smolagents/tutorials/building_good_agents) - Un guide d√©taill√© sur les meilleures pratiques pour d√©velopper des agents de fonctions personnalis√©es fiables et performants.