<CourseFloatingBanner 
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/#fileId=https://huggingface.co/agents-course/notebooks/blob/main/fr/unit2/smolagents/multiagent_notebook.ipynb"},
]}
askForHelpUrl="http://hf.co/join/discord" />

# Syst√®mes multi-agents

Les syst√®mes multi-agents permettent √† des **agents sp√©cialis√©s de collaborer sur des t√¢ches complexes**, am√©liorant la modularit√©, la scalabilit√© et la robustesse. Au lieu de s'appuyer sur un seul agent, les t√¢ches sont distribu√©es entre des agents ayant des capacit√©s distinctes.

Dans `smolagents`, diff√©rents agents peuvent √™tre combin√©s pour g√©n√©rer du code Python, appeler des outils externes, effectuer des recherches web et plus encore. En orchestrant ces agents, nous pouvons cr√©er des flux de travail puissants.

Une configuration typique pourrait inclure :
- Un **agent manageur** pour la d√©l√©gation des t√¢ches
- Un **agent interpr√©teur de code** pour l'ex√©cution de code
- Un **agent de recherche web** pour la r√©cup√©ration d'informations

Le diagramme ci-dessous illustre une architecture multi-agents simple o√π un **agent manageur** coordonne un **outil interpr√©teur de code** et un **agent de recherche web**, qui √† son tour utilise des outils comme `DuckDuckGoSearchTool` et `VisitWebpageTool` pour rassembler des informations pertinentes.

<img src="https://mermaid.ink/img/pako:eNp1kc1qhTAQRl9FUiQb8wIpdNO76eKubrmFks1oRg3VSYgjpYjv3lFL_2hnMWQOJwn5sqgmelRWleUSKLAtFs09jqhtoWuYUFfFAa6QA9QDTnpzamheuhxn8pt40-6l13UtS0ddhtQXj6dbR4XUGQg6zEYasTF393KjeSDGnDJKNxzj8I_7hLW5IOSmP9CH9hv_NL-d94d4DVNg84p1EnK4qlIj5hGClySWbadT-6OdsrL02MI8sFOOVkciw8zx8kaNspxnrJQE0fXKtjBMMs3JA-MpgOQwftIE9Bzj14w-cMznI_39E9Z3p0uFoA?type=png" style='background: white;'>

## Syst√®mes multi-agents en action

Un syst√®me multi-agents se compose de plusieurs agents sp√©cialis√©s travaillant ensemble sous la coordination d'un **agent orchestrateur**. Cette approche permet des flux de travail complexes en distribuant les t√¢ches entre des agents ayant des r√¥les distincts.

Par exemple, un **syst√®me de RAG multi-agents** peut int√©grer :
- Un **agent web** pour naviguer sur internet.
- Un **agent r√©cup√©rateur** pour r√©cup√©rer des informations √† partir de bases de connaissances.
- Un **agent de g√©n√©ration d'images** pour produire des visuels.

Tous ces agents op√®rent sous un orchestrateur qui g√®re la d√©l√©gation de t√¢ches et l'interaction.

## R√©soudre une t√¢che complexe avec une hi√©rarchie multi-agents

> [!TIP]
> Vous pouvez suivre le code dans <a href="https://huggingface.co/agents-course/notebooks/blob/main/fr/unit2/smolagents/multiagent_notebook.ipynb" target="_blank">ce <i>notebook</i></a> que vous pouvez ex√©cuter avec Google Colab.

La r√©ception approche ! Avec votre aide, Alfred a presque termin√© les pr√©paratifs.

Mais maintenant il y a un probl√®me : la Batmobile a disparu. Alfred doit trouver une rempla√ßante, et la trouver rapidement.

Heureusement, quelques biographies ont √©t√© r√©alis√©es sur la vie de Bruce Wayne, alors peut-√™tre qu'Alfred pourrait r√©cup√©rer une voiture abandonn√©e sur l'un des plateaux de tournage et la reconditionner selon les normes modernes, ce qui inclurait certainement une option de conduite enti√®rement autonome.

Mais cela pourrait √™tre n'importe o√π dans les lieux de tournage autour du monde ; pouvant √™tre nombreux.

Donc Alfred n√©cessite votre aide. Pourriez-vous construire un agent capable de r√©soudre cette t√¢che ?

> üëâ Trouvez tous les lieux de tournage de Batman dans le monde, calculez le temps de transfert par cargo jusqu'√† ces lieux, et repr√©sentez-les sur une carte, avec une couleur variant en fonction du temps de transfert par cargo. Repr√©sentez √©galement quelques usines de supercars avec le m√™me temps de transfert en cargo.

Construisons cela !

Cet exemple n√©cessite des packages suppl√©mentaires, donc installons-les d'abord :

```bash
pip install 'smolagents[litellm]' plotly geopandas shapely kaleido -q
```

### Nous cr√©ons d'abord un outil pour obtenir le temps de transfert en avion cargo.

```python
import math
from typing import Optional, Tuple

from smolagents import tool


@tool
def calculate_cargo_travel_time(
    origin_coords: Tuple[float, float],
    destination_coords: Tuple[float, float],
    cruising_speed_kmh: Optional[float] = 750.0,  # Vitesse moyenne pour les avions cargo
) -> float:
    """
    Calcule le temps de voyage pour un avion cargo entre deux points sur Terre en utilisant la distance du grand cercle.

    Args:
        origin_coords: Tuple de (latitude, longitude) pour le point de d√©part
        destination_coords: Tuple de (latitude, longitude) pour la destination
        cruising_speed_kmh: Vitesse de croisi√®re optionnelle en km/h (par d√©faut 750 km/h pour les avions cargo typiques)

    Returns:
        float: Le temps de voyage estim√© en heures

    Example:
        >>> # Chicago (41.8781¬∞ N, 87.6298¬∞ W) vers Sydney (33.8688¬∞ S, 151.2093¬∞ E)
        >>> result = calculate_cargo_travel_time((41.8781, -87.6298), (-33.8688, 151.2093))
    """

    def to_radians(degrees: float) -> float:
        return degrees * (math.pi / 180)

    # Extraire les coordonn√©es
    lat1, lon1 = map(to_radians, origin_coords)
    lat2, lon2 = map(to_radians, destination_coords)

    # Rayon de la Terre en kilom√®tres
    EARTH_RADIUS_KM = 6371.0

    # Calculer la distance du grand cercle en utilisant la formule de haversine
    dlon = lon2 - lon1
    dlat = lat2 - lat1

    a = (
        math.sin(dlat / 2) ** 2
        + math.cos(lat1) * math.cos(lat2) * math.sin(dlon / 2) ** 2
    )
    c = 2 * math.asin(math.sqrt(a))
    distance = EARTH_RADIUS_KM * c

    # Ajouter 10% pour tenir compte des routes non directes et des contr√¥les de trafic a√©rien
    actual_distance = distance * 1.1

    # Calculer le temps de vol
    # Ajouter 1 heure pour les proc√©dures de d√©collage et d'atterrissage
    flight_time = (actual_distance / cruising_speed_kmh) + 1.0

    # Formater les r√©sultats
    return round(flight_time, 2)


print(calculate_cargo_travel_time((41.8781, -87.6298), (-33.8688, 151.2093)))
```

### Configuration de l'agent

Pour le fournisseur de mod√®le, nous utilisons Together AI, l'un des nouveaux [fournisseurs d'inf√©rence sur le Hub](https://huggingface.co/blog/inference-providers) !

Le `GoogleSearchTool` utilise l'[API Serper](https://serper.dev) pour rechercher sur le web, cela n√©cessite donc soit d'avoir configur√© la variable d'environnement `SERPAPI_API_KEY` et de passer `provider="serpapi"` ou d'avoir `SERPER_API_KEY` et de passer `provider=serper`.

Si vous n'avez pas de fournisseur Serp API configur√©, vous pouvez utiliser `DuckDuckGoSearchTool` mais attention il a une limite d'appels.

```python
import os
from PIL import Image
from smolagents import CodeAgent, GoogleSearchTool, InferenceClientModel, VisitWebpageTool

model = InferenceClientModel(model_id="Qwen/Qwen2.5-Coder-32B-Instruct", provider="together")
```

Nous pouvons commencer par cr√©er un agent simple comme ligne de base pour nous donner un rapport simple.

```python
task = """Trouvez tous les lieux de tournage de Batman dans le monde, calculez le temps de transfert par avion cargo jusqu'ici (nous sommes √† Gotham, 40.7128¬∞ N, 74.0060¬∞ W), et renvoyez-les moi sous la forme d'un dataframe pandas.
Donnez-moi aussi des usines de supercars avec le m√™me temps de transfert par avion-cargo."""
```

```python
agent = CodeAgent(
    model=model,
    tools=[GoogleSearchTool("serper"), VisitWebpageTool(), calculate_cargo_travel_time],
    additional_authorized_imports=["pandas"],
    max_steps=20,
)
```

```python
result = agent.run(task)
```

```python
result
```

Dans notre cas, il g√©n√®re cette sortie :

```python
|  | Location                                             | Travel Time to Gotham (hours) |
|--|------------------------------------------------------|------------------------------|
| 0  | Necropolis Cemetery, Glasgow, Scotland, UK         | 8.60                         |
| 1  | St. George's Hall, Liverpool, England, UK         | 8.81                         |
| 2  | Two Temple Place, London, England, UK             | 9.17                         |
| 3  | Wollaton Hall, Nottingham, England, UK           | 9.00                         |
| 4  | Knebworth House, Knebworth, Hertfordshire, UK    | 9.15                         |
| 5  | Acton Lane Power Station, Acton Lane, Acton, UK  | 9.16                         |
| 6  | Queensboro Bridge, New York City, USA            | 1.01                         |
| 7  | Wall Street, New York City, USA                  | 1.00                         |
| 8  | Mehrangarh Fort, Jodhpur, Rajasthan, India       | 18.34                        |
| 9  | Turda Gorge, Turda, Romania                      | 11.89                        |
| 10 | Chicago, USA                                     | 2.68                         |
| 11 | Hong Kong, China                                 | 19.99                        |
| 12 | Cardington Studios, Northamptonshire, UK        | 9.10                         |
| 13 | Warner Bros. Leavesden Studios, Hertfordshire, UK | 9.13                         |
| 14 | Westwood, Los Angeles, CA, USA                  | 6.79                         |
| 15 | Woking, UK (McLaren)                             | 9.13                         |
```

Nous pourrions d√©j√† l'am√©liorer un peu en ajoutant des √©tapes de planification d√©di√©es et en ajoutant davantage de *prompts*.

Les √©tapes de planification permettent √† l'agent de penser √† l'avance et planifier ses prochaines √©tapes, ce qui peut √™tre utile pour des t√¢ches plus complexes.

```python
agent.planning_interval = 4

detailed_report = agent.run(f"""
Vous √™tes un analyste expert. Vous r√©digez des rapports complets apr√®s avoir visit√© de nombreux sites web.
N'h√©sitez pas √† effectuer plusieurs recherches √† la fois dans une boucle for.
Pour chaque point de donn√©es que vous trouvez, visitez l'url source pour confirmer les chiffres.

{task}
""")

print(detailed_report)
```

```python
detailed_report
```

Dans notre cas, il g√©n√®re cette sortie :

```python
|  | Location                                         | Travel Time (hours) |
|--|--------------------------------------------------|---------------------|
| 0  | Bridge of Sighs, Glasgow Necropolis, Glasgow, UK | 8.6                 |
| 1  | Wishart Street, Glasgow, Scotland, UK         | 8.6                 |
```

Gr√¢ce √† ces changements rapides, nous avons obtenu un rapport beaucoup plus concis en fournissant simplement √† notre agent un *prompt* d√©taill√©, et en lui donnant des capacit√©s de planification !

La fen√™tre de contexte du mod√®le se remplit rapidement. Donc **si nous demandons √† notre agent de combiner les r√©sultats de recherche d√©taill√©e avec une autre, il sera plus lent et cela augmentera rapidement le nombre de *tokens* utilis√©s et donc les co√ªts**.

‚û°Ô∏è Nous devons am√©liorer la structure de notre syst√®me.

### ‚úåÔ∏è Diviser la t√¢che entre deux agents

Les structures multi-agents permettent de s√©parer les m√©moires entre diff√©rentes sous-t√¢ches, avec deux grands avantages :
- Chaque agent est davantage focalis√© sur sa t√¢che principale, donc plus performant
- S√©parer les m√©moires r√©duit le nombre de *tokens* d'entr√©e √† chaque √©tape, r√©duisant ainsi la latence et le co√ªt.

Cr√©ons une √©quipe avec un agent de recherche web d√©di√©, g√©r√© par un autre agent.

L'agent gestionnaire devrait avoir des capacit√©s de tra√ßage pour √©crire son rapport final : donnons-lui donc acc√®s √† des importations suppl√©mentaires, incluant `plotly`, et `geopandas` + `shapely` pour le tra√ßage spatial.

```python
model = InferenceClientModel(
    "Qwen/Qwen2.5-Coder-32B-Instruct", provider="together", max_tokens=8096
)

web_agent = CodeAgent(
    model=model,
    tools=[
        GoogleSearchTool(provider="serper"),
        VisitWebpageTool(),
        calculate_cargo_travel_time,
    ],
    name="web_agent",
    description="Navigue sur le web pour trouver des informations",
    verbosity_level=0,
    max_steps=10,
)
```

L'agent gestionnaire aura besoin de faire du travail mental intensif.

Donc nous lui donnons le mod√®le plus puissant [DeepSeek-R1](https://huggingface.co/deepseek-ai/DeepSeek-R1), et ajoutons un `planning_interval` au m√©lange.

```python
from smolagents.utils import encode_image_base64, make_image_url
from smolagents import OpenAIServerModel


def check_reasoning_and_plot(final_answer, agent_memory):
    multimodal_model = OpenAIServerModel("gpt-4o", max_tokens=8096)
    filepath = "saved_map.png"
    assert os.path.exists(filepath), "Assurez-vous de sauvegarder le graphique sous saved_map.png !"
    image = Image.open(filepath)
    prompt = (
        f"Voici une t√¢che donn√©e par l'utilisateur et les √©tapes de l'agent : {agent_memory.get_succinct_steps()}. Maintenant voici le graphique qui a √©t√© fait."
        "Veuillez v√©rifier que le processus de raisonnement et le graphique sont corrects : r√©pondent-ils correctement √† la t√¢che donn√©e ?"
        "Listez d'abord les raisons pour lesquelles oui/non, puis √©crivez votre d√©cision finale : PASS en majuscules si c'est satisfaisant, FAIL si ce n'est pas le cas."
        "Ne soyez pas dur : si le graphique r√©sout principalement la t√¢che, il devrait passer."
        "Pour passer, un graphique devrait √™tre fait en utilisant px.scatter_map et non toute autre m√©thode (scatter_map a l'air plus joli)."
    )
    messages = [
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": prompt,
                },
                {
                    "type": "image_url",
                    "image_url": {"url": make_image_url(encode_image_base64(image))},
                },
            ],
        }
    ]
    output = multimodal_model(messages).content
    print("Feedback: ", output)
    if "FAIL" in output:
        raise Exception(output)
    return True


manager_agent = CodeAgent(
    model=InferenceClientModel("deepseek-ai/DeepSeek-R1", provider="together", max_tokens=8096),
    tools=[calculate_cargo_travel_time],
    managed_agents=[web_agent],
    additional_authorized_imports=[
        "geopandas",
        "plotly",
        "shapely",
        "json",
        "pandas",
        "numpy",
    ],
    planning_interval=5,
    verbosity_level=2,
    final_answer_checks=[check_reasoning_and_plot],
    max_steps=15,
)
```

Inspectons √† quoi ressemble cette √©quipe :

```python
manager_agent.visualize()
```

Cela g√©n√©rera quelque chose comme ceci, nous aidant √† comprendre la structure et les relations entre les agents et les outils utilis√©s :

```python
CodeAgent | deepseek-ai/DeepSeek-R1
‚îú‚îÄ‚îÄ ‚úÖ Importations autoris√©es : ['geopandas', 'plotly', 'shapely', 'json', 'pandas', 'numpy']
‚îú‚îÄ‚îÄ üõ†Ô∏è Outils :
‚îÇ   ‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì
‚îÇ   ‚îÉ Nom                         ‚îÉ Description                           ‚îÉ Arguments                             ‚îÉ
‚îÇ   ‚î°‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î©
‚îÇ   ‚îÇ calculate_cargo_travel_time ‚îÇ Calcule le temps de voyage pour un    ‚îÇ origin_coords (`array`) : Tuple de    ‚îÇ
‚îÇ   ‚îÇ                             ‚îÇ avion cargo entre deux points sur     ‚îÇ (latitude, longitude) pour le         ‚îÇ
‚îÇ   ‚îÇ                             ‚îÇ Terre en utilisant la distance du     ‚îÇ point de d√©part                       ‚îÇ
‚îÇ   ‚îÇ                             ‚îÇ grand cercle.                          ‚îÇ destination_coords (`array`) : Tuple  ‚îÇ
‚îÇ   ‚îÇ                             ‚îÇ                                       ‚îÇ de (latitude, longitude) pour la      ‚îÇ
‚îÇ   ‚îÇ                             ‚îÇ                                       ‚îÇ destination                           ‚îÇ
‚îÇ   ‚îÇ                             ‚îÇ                                       ‚îÇ cruising_speed_kmh (`number`) :       ‚îÇ
‚îÇ   ‚îÇ                             ‚îÇ                                       ‚îÇ Vitesse de croisi√®re optionnelle      ‚îÇ
‚îÇ   ‚îÇ                             ‚îÇ                                       ‚îÇ en km/h (par d√©faut 750 km/h pour     ‚îÇ
‚îÇ   ‚îÇ                             ‚îÇ                                       ‚îÇ les avions cargo typiques)            ‚îÇ
‚îÇ   ‚îÇ final_answer                ‚îÇ Fournit une r√©ponse finale au probl√®me ‚îÇ answer (`any`) : La r√©ponse finale    ‚îÇ
‚îÇ   ‚îÇ                             ‚îÇ donn√©.                                ‚îÇ au probl√®me                           ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ ü§ñ Agents g√©r√©s :
    ‚îî‚îÄ‚îÄ web_agent | CodeAgent | Qwen/Qwen2.5-Coder-32B-Instruct
        ‚îú‚îÄ‚îÄ ‚úÖ Importations autoris√©es : []
        ‚îú‚îÄ‚îÄ üìù Description : Navigue sur le web pour trouver des informations
        ‚îî‚îÄ‚îÄ üõ†Ô∏è Outils :
            ‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì
            ‚îÉ Nom                         ‚îÉ Description                       ‚îÉ Arguments                         ‚îÉ
            ‚î°‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î©
            ‚îÇ web_search                  ‚îÇ Effectue une recherche web Google ‚îÇ query (`string`) : La requ√™te de  ‚îÇ
            ‚îÇ                             ‚îÇ pour votre requ√™te puis retourne  ‚îÇ recherche √† effectuer.            ‚îÇ
            ‚îÇ                             ‚îÇ une cha√Æne des meilleurs r√©sultats ‚îÇ filter_year (`integer`) :         ‚îÇ
            ‚îÇ                             ‚îÇ de recherche.                      ‚îÇ Optionnellement restreindre les   ‚îÇ
            ‚îÇ                             ‚îÇ                                   ‚îÇ r√©sultats √† une certaine ann√©e    ‚îÇ
            ‚îÇ visit_webpage               ‚îÇ Visite une page web √† l'URL donn√©e ‚îÇ url (`string`) : L'URL de la page ‚îÇ
            ‚îÇ                             ‚îÇ et lit son contenu comme une      ‚îÇ web √† visiter.                    ‚îÇ
            ‚îÇ                             ‚îÇ cha√Æne markdown. Utilisez ceci    ‚îÇ                                   ‚îÇ
            ‚îÇ                             ‚îÇ pour naviguer sur les pages web.  ‚îÇ                                   ‚îÇ
            ‚îÇ calculate_cargo_travel_time ‚îÇ Calcule le temps de voyage pour un ‚îÇ origin_coords (`array`) : Tuple de ‚îÇ
            ‚îÇ                             ‚îÇ avion cargo entre deux points sur ‚îÇ (latitude, longitude) pour le     ‚îÇ
            ‚îÇ                             ‚îÇ Terre en utilisant la distance du ‚îÇ point de d√©part                   ‚îÇ
            ‚îÇ                             ‚îÇ grand cercle.                      ‚îÇ destination_coords (`array`) :    ‚îÇ
            ‚îÇ                             ‚îÇ                                   ‚îÇ Tuple de (latitude, longitude)    ‚îÇ
            ‚îÇ                             ‚îÇ                                   ‚îÇ pour la destination               ‚îÇ
            ‚îÇ                             ‚îÇ                                   ‚îÇ cruising_speed_kmh (`number`) :   ‚îÇ
            ‚îÇ                             ‚îÇ                                   ‚îÇ Vitesse de croisi√®re optionnelle  ‚îÇ
            ‚îÇ                             ‚îÇ                                   ‚îÇ en km/h (par d√©faut 750 km/h pour ‚îÇ
            ‚îÇ                             ‚îÇ                                   ‚îÇ les avions cargo typiques)        ‚îÇ
            ‚îÇ final_answer                ‚îÇ Fournit une r√©ponse finale au     ‚îÇ answer (`any`) : La r√©ponse finale ‚îÇ
            ‚îÇ                             ‚îÇ probl√®me donn√©.                   ‚îÇ au probl√®me                       ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

```python
manager_agent.run("""
Find all Batman filming locations in the world, calculate the time to transfer via cargo plane to here (we're in Gotham, 40.7128¬∞ N, 74.0060¬∞ W).
Also give me some supercar factories with the same cargo plane transfer time. You need at least 6 points in total.
Represent this as spatial map of the world, with the locations represented as scatter points with a color that depends on the travel time, and save it to saved_map.png!

Here's an example of how to plot and return a map:
import plotly.express as px
df = px.data.carshare()
fig = px.scatter_map(df, lat="centroid_lat", lon="centroid_lon", text="name", color="peak_hour", size=100,
     color_continuous_scale=px.colors.sequential.Magma, size_max=15, zoom=1)
fig.show()
fig.write_image("saved_image.png")
final_answer(fig)

Never try to process strings using code: when you have a string to read, just print it and you'll see it.
""")
```

Je ne sais pas comment cela s'est pass√© pour votre ex√©cution, mais dans la mienne, l'agent gestionnaire a habilement divis√© les t√¢ches donn√©es √† l'agent web en `1. Rechercher les lieux de tournage de Batman`, puis `2. Trouver les usines de supercars`, avant d'agr√©ger les listes et de tracer la carte.

Voyons √† quoi ressemble la carte en l'inspectant directement depuis l'√©tat de l'agent :

```python
manager_agent.python_executor.state["fig"]
```

Cela affichera la carte :

![Exemple de sortie de carte du syst√®me multi-agents](https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit2/smolagents/output_map.png)

## Ressources

- [Syst√®mes multi-agents](https://huggingface.co/docs/smolagents/main/en/examples/multiagents) ‚Äì Aper√ßu des syst√®mes multi-agents.
- [Qu'est-ce que le RAG agentique ?](https://weaviate.io/blog/what-is-agentic-rag) ‚Äì Introduction au RAG agentique.
- [Syst√®me RAG multi-agents ü§ñü§ùü§ñ Recette](https://huggingface.co/learn/cookbook/multiagent_rag_system) ‚Äì Guide √©tape par √©tape pour construire un syst√®me RAG multi-agents.