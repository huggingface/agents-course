# X√¢y d·ª±ng v√† T√≠ch h·ª£p C√¥ng c·ª• cho T√°c nh√¢n c·ªßa B·∫°n

Trong ph·∫ßn n√†y, ch√∫ng ta s·∫Ω c·∫•p cho Alfred quy·ªÅn truy c·∫≠p web ƒë·ªÉ anh ·∫•y c√≥ th·ªÉ t√¨m ki·∫øm tin t·ª©c m·ªõi nh·∫•t v√† c·∫≠p nh·∫≠t to√†n c·∫ßu.  
Ngo√†i ra, anh ·∫•y s·∫Ω c√≥ quy·ªÅn truy c·∫≠p d·ªØ li·ªáu th·ªùi ti·∫øt v√† th·ªëng k√™ t·∫£i xu·ªëng model t·ª´ Hugging Face hub, gi√∫p anh ·∫•y c√≥ th·ªÉ tr√≤ chuy·ªán v·ªÅ c√°c ch·ªß ƒë·ªÅ n√≥ng h·ªïi.

## C·∫•p cho T√°c nh√¢n Quy·ªÅn Truy c·∫≠p Web

H√£y nh·ªõ r·∫±ng ch√∫ng ta mu·ªën Alfred th·ªÉ hi·ªán h√¨nh ·∫£nh m·ªôt ch·ªß nh√† ƒëa t√†i v·ªõi ki·∫øn th·ª©c s√¢u r·ªông v·ªÅ th·∫ø gi·ªõi.  

ƒê·ªÉ l√†m ƒë∆∞·ª£c ƒëi·ªÅu n√†y, ta c·∫ßn ƒë·∫£m b·∫£o Alfred c√≥ quy·ªÅn truy c·∫≠p tin t·ª©c v√† th√¥ng tin m·ªõi nh·∫•t v·ªÅ th·∫ø gi·ªõi.  

H√£y b·∫Øt ƒë·∫ßu b·∫±ng c√°ch t·∫°o c√¥ng c·ª• t√¨m ki·∫øm web cho Alfred!

<hfoptions id="agents-frameworks">
<hfoption id="smolagents">

```python
from smolagents import DuckDuckGoSearchTool

# Kh·ªüi t·∫°o c√¥ng c·ª• t√¨m ki·∫øm DuckDuckGo
search_tool = DuckDuckGoSearchTool()

# V√≠ d·ª• s·ª≠ d·ª•ng
results = search_tool("Who's the current President of France?")
print(results)
```

K·∫øt qu·∫£ mong ƒë·ª£i:

```
The current President of France in Emmanuel Macron.
```


</hfoption>
<hfoption id="llama-index">

```python
from llama_index.tools.duckduckgo import DuckDuckGoSearchToolSpec
from llama_index.core.tools import FunctionTool

# Initialize the DuckDuckGo search tool
tool_spec = DuckDuckGoSearchToolSpec()

search_tool = FunctionTool.from_defaults(tool_spec.duckduckgo_full_search)
# Example usage
response = search_tool("Who's the current President of France?")
print(response.raw_output[-1]['body'])
```

K·∫øt qu·∫£ mong ƒë·ª£i:

```
The President of the French Republic is the head of state of France. The current President is Emmanuel Macron since 14 May 2017 defeating Marine Le Pen in the second round of the presidential election on 7 May 2017. List of French presidents (Fifth Republic) N¬∞ Portrait Name ...
```

</hfoption>
<hfoption id="langgraph">

```python
from langchain_community.tools import DuckDuckGoSearchRun

search_tool = DuckDuckGoSearchRun()
results = search_tool.invoke("Who's the current President of France?")
print(results)
```

K·∫øt qu·∫£ mong ƒë·ª£i:

```
Emmanuel Macron (born December 21, 1977, Amiens, France) is a French banker and politician who was elected president of France in 2017...
```

</hfoption>
</hfoptions>

## T·∫°o C√¥ng c·ª• T√πy ch·ªânh ƒë·ªÉ L·∫•y Th√¥ng tin Th·ªùi ti·∫øt cho L·ªãch Tr√¨nh B·∫Øn Ph√°o hoa

Bu·ªïi ti·ªác gala ho√†n h·∫£o c·∫ßn c√≥ ph√°o hoa tr√™n b·∫ßu tr·ªùi quang ƒë√£ng, ch√∫ng ta ph·∫£i ƒë·∫£m b·∫£o ph√°o hoa kh√¥ng b·ªã h·ªßy do th·ªùi ti·∫øt x·∫•u.

H√£y t·∫°o m·ªôt c√¥ng c·ª• t√πy ch·ªânh ƒë·ªÉ g·ªçi API th·ªùi ti·∫øt b√™n ngo√†i v√† l·∫•y th√¥ng tin th·ªùi ti·∫øt cho ƒë·ªãa ƒëi·ªÉm c·ª• th·ªÉ.

<Tip>
ƒê·ªÉ ƒë∆°n gi·∫£n, ta s·ª≠ d·ª•ng API th·ªùi ti·∫øt ·∫£o (dummy) cho v√≠ d·ª• n√†y. N·∫øu mu·ªën d√πng API th·ªùi ti·∫øt th·∫≠t, b·∫°n c√≥ th·ªÉ tri·ªÉn khai c√¥ng c·ª• s·ª≠ d·ª•ng OpenWeatherMap API nh∆∞ trong <a href="../../unit1/tutorial">Ch∆∞∆°ng 1</a>.
</Tip>

<hfoptions id="agents-frameworks">
<hfoption id="smolagents">

```python
from smolagents import Tool
import random

class WeatherInfoTool(Tool):
    name = "weather_info"
    description = "L·∫•y th√¥ng tin th·ªùi ti·∫øt ·∫£o cho ƒë·ªãa ƒëi·ªÉm ch·ªâ ƒë·ªãnh."
    inputs = {
        "location": {
            "type": "string",
            "description": "ƒê·ªãa ƒëi·ªÉm c·∫ßn l·∫•y th√¥ng tin th·ªùi ti·∫øt."
        }
    }
    output_type = "string"

    def forward(self, location: str):
        # D·ªØ li·ªáu th·ªùi ti·∫øt ·∫£o
        weather_conditions = [
            {"condition": "Rainy", "temp_c": 15},
            {"condition": "Clear", "temp_c": 25},
            {"condition": "Windy", "temp_c": 20}
        ]
        # Ch·ªçn ng·∫´u nhi√™n ƒëi·ªÅu ki·ªán th·ªùi ti·∫øt
        data = random.choice(weather_conditions)
        return f"Weather in {location}: {data['condition']}, {data['temp_c']}¬∞C"

# Kh·ªüi t·∫°o c√¥ng c·ª•
weather_info_tool = WeatherInfoTool()
```

</hfoption>
<hfoption id="llama-index">

```python
import random
from llama_index.core.tools import FunctionTool

def get_weather_info(location: str) -> str:
    """L·∫•y th√¥ng tin th·ªùi ti·∫øt ·∫£o cho ƒë·ªãa ƒëi·ªÉm ch·ªâ ƒë·ªãnh."""
    # D·ªØ li·ªáu th·ªùi ti·∫øt ·∫£o
    weather_conditions = [
        {"condition": "Rainy", "temp_c": 15},
        {"condition": "Clear", "temp_c": 25},
        {"condition": "Windy", "temp_c": 20}
    ]
    # Ch·ªçn ng·∫´u nhi√™n ƒëi·ªÅu ki·ªán th·ªùi ti·∫øt
    data = random.choice(weather_conditions)
    return f"Weather in {location}: {data['condition']}, {data['temp_c']}¬∞C"

# Kh·ªüi t·∫°o c√¥ng c·ª•
weather_info_tool = FunctionTool.from_defaults(get_weather_info)
```

</hfoption>
<hfoption id="langgraph">

```python
from langchain.tools import Tool
import random

def get_weather_info(location: str) -> str:
    """L·∫•y th√¥ng tin th·ªùi ti·∫øt ·∫£o cho ƒë·ªãa ƒëi·ªÉm ch·ªâ ƒë·ªãnh."""
    # D·ªØ li·ªáu th·ªùi ti·∫øt ·∫£o
    weather_conditions = [
        {"condition": "Rainy", "temp_c": 15},
        {"condition": "Clear", "temp_c": 25},
        {"condition": "Windy", "temp_c": 20}
    ]
    # Ch·ªçn ng·∫´u nhi√™n ƒëi·ªÅu ki·ªán th·ªùi ti·∫øt
    data = random.choice(weather_conditions)
    return f"Weather in {location}: {data['condition']}, {data['temp_c']}¬∞C"

# Kh·ªüi t·∫°o c√¥ng c·ª•
weather_info_tool = Tool(
    name="get_weather_info",
    func=get_weather_info,
    description="L·∫•y th√¥ng tin th·ªùi ti·∫øt ·∫£o cho ƒë·ªãa ƒëi·ªÉm ch·ªâ ƒë·ªãnh."
)
```

</hfoption>
</hfoptions>

## T·∫°o C√¥ng c·ª• Th·ªëng k√™ Hub cho Nh√† Ph√°t tri·ªÉn AI C√≥ T·∫ßm ·∫¢nh H∆∞·ªüng

Tham d·ª± bu·ªïi gala l√† nh·ªØng nh√¢n v·∫≠t h√†ng ƒë·∫ßu trong gi·ªõi ph√°t tri·ªÉn AI. Alfred mu·ªën g√¢y ·∫•n t∆∞·ª£ng b·∫±ng c√°ch th·∫£o lu·∫≠n v·ªÅ c√°c m√¥ h√¨nh, t·∫≠p d·ªØ li·ªáu v√† Space ph·ªï bi·∫øn nh·∫•t c·ªßa h·ªç. Ta s·∫Ω t·∫°o c√¥ng c·ª• l·∫•y th·ªëng k√™ m√¥ h√¨nh t·ª´ Hugging Face Hub d·ª±a tr√™n t√™n ng∆∞·ªùi d√πng.

<hfoptions id="agents-frameworks">
<hfoption id="smolagents">

```python
from smolagents import Tool
from huggingface_hub import list_models

class HubStatsTool(Tool):
    name = "hub_stats"
    description = "L·∫•y model ƒë∆∞·ª£c t·∫£i nhi·ªÅu nh·∫•t t·ª´ t√°c gi·∫£ c·ª• th·ªÉ tr√™n Hugging Face Hub."
    inputs = {
        "author": {
            "type": "string",
            "description": "T√™n ng∆∞·ªùi d√πng/t·ªï ch·ª©c t√°c gi·∫£ model c·∫ßn t√¨m."
        }
    }
    output_type = "string"

    def forward(self, author: str):
        try:
            # Li·ªát k√™ model t·ª´ t√°c gi·∫£ ch·ªâ ƒë·ªãnh, s·∫Øp x·∫øp theo l∆∞·ª£t t·∫£i
            models = list(list_models(author=author, sort="downloads", direction=-1, limit=1))
            
            if models:
                model = models[0]
                return f"The most downloaded model by {author} is {model.id} with {model.downloads:,} downloads."
            else:
                return f"No models found for author {author}."
        except Exception as e:
            return f"Error fetching models for {author}: {str(e)}"

# Kh·ªüi t·∫°o c√¥ng c·ª•
hub_stats_tool = HubStatsTool()

# V√≠ d·ª• s·ª≠ d·ª•ng
print(hub_stats_tool("facebook")) # V√≠ d·ª•: L·∫•y model ƒë∆∞·ª£c t·∫£i nhi·ªÅu nh·∫•t c·ªßa Facebook
```

K·∫øt qu·∫£ mong ƒë·ª£i:

```
The most downloaded model by facebook is facebook/esmfold_v1 with 12,544,550 downloads.
```

</hfoption>
<hfoption id="llama-index">

```python
import random
from llama_index.core.tools import FunctionTool
from huggingface_hub import list_models

def get_hub_stats(author: str) -> str:
    """L·∫•y model ƒë∆∞·ª£c t·∫£i nhi·ªÅu nh·∫•t t·ª´ t√°c gi·∫£ c·ª• th·ªÉ tr√™n Hugging Face Hub."""
    try:
        # Li·ªát k√™ model t·ª´ t√°c gi·∫£ ch·ªâ ƒë·ªãnh, s·∫Øp x·∫øp theo l∆∞·ª£t t·∫£i
        models = list(list_models(author=author, sort="downloads", direction=-1, limit=1))

        if models:
            model = models[0]
            return f"The most downloaded model by {author} is {model.id} with {model.downloads:,} downloads."
        else:
            return f"No models found for author {author}."
    except Exception as e:
        return f"Error fetching models for {author}: {str(e)}"

# Kh·ªüi t·∫°o c√¥ng c·ª•
hub_stats_tool = FunctionTool.from_defaults(get_hub_stats)

# V√≠ d·ª• s·ª≠ d·ª•ng
print(hub_stats_tool("facebook")) # V√≠ d·ª•: L·∫•y model ƒë∆∞·ª£c t·∫£i nhi·ªÅu nh·∫•t c·ªßa Facebook
```

K·∫øt qu·∫£ mong ƒë·ª£i:

```
The most downloaded model by facebook is facebook/esmfold_v1 with 12,544,550 downloads.
```

</hfoption>
<hfoption id="langgraph">


```python
from langchain.tools import Tool
from huggingface_hub import list_models

def get_hub_stats(author: str) -> str:
    """Fetches the most downloaded model from a specific author on the Hugging Face Hub."""
    try:
        # List models from the specified author, sorted by downloads
        models = list(list_models(author=author, sort="downloads", direction=-1, limit=1))

        if models:
            model = models[0]
            return f"The most downloaded model by {author} is {model.id} with {model.downloads:,} downloads."
        else:
            return f"No models found for author {author}."
    except Exception as e:
        return f"Error fetching models for {author}: {str(e)}"

# Initialize the tool
hub_stats_tool = Tool(
    name="get_hub_stats",
    func=get_hub_stats,
    description="Fetches the most downloaded model from a specific author on the Hugging Face Hub."
)

# Example usage
print(hub_stats_tool("facebook")) # Example: Get the most downloaded model by Facebook
```

K·∫øt qu·∫£ mong ƒë·ª£i:

```
The most downloaded model by facebook is facebook/esmfold_v1 with 13,109,861 downloads.
```

</hfoption>
</hfoptions>

V·ªõi C√¥ng c·ª• Th·ªëng k√™ Hub, gi·ªù ƒë√¢y Alfred c√≥ th·ªÉ g√¢y ·∫•n t∆∞·ª£ng v·ªõi c√°c nh√† x√¢y d·ª±ng AI c√≥ ·∫£nh h∆∞·ªüng b·∫±ng c√°ch th·∫£o lu·∫≠n v·ªÅ c√°c m√¥ h√¨nh ph·ªï bi·∫øn nh·∫•t c·ªßa h·ªç.

## T√≠ch h·ª£p C√¥ng c·ª• v·ªõi Alfred

Gi·ªù ch√∫ng ta ƒë√£ c√≥ t·∫•t c·∫£ c√¥ng c·ª•, h√£y t√≠ch h·ª£p ch√∫ng v√†o t√°c nh√¢n Alfred:

<hfoptions id="agents-frameworks">
<hfoption id="smolagents">

```python
from smolagents import CodeAgent, InferenceClientModel

# Kh·ªüi t·∫°o m√¥ h√¨nh Hugging Face
model = InferenceClientModel()

# T·∫°o Alfred v·ªõi t·∫•t c·∫£ c√¥ng c·ª•
alfred = CodeAgent(
    tools=[search_tool, weather_info_tool, hub_stats_tool], 
    model=model
)

# Truy v·∫•n m·∫´u Alfred c√≥ th·ªÉ nh·∫≠n trong bu·ªïi ti·ªác
response = alfred.run("What is Facebook and what's their most popular model?")

print("üé© Alfred's Response:")
print(response)
```

K·∫øt qu·∫£ mong ƒë·ª£i: 

```
üé© Alfred's Response:
Facebook is a social networking website where users can connect, share information, and interact with others. The most downloaded model by Facebook on the Hugging Face Hub is ESMFold_v1.
```

</hfoption>
<hfoption id="llama-index">

```python
from llama_index.core.agent.workflow import AgentWorkflow
from llama_index.llms.huggingface_api import HuggingFaceInferenceAPI

# Kh·ªüi t·∫°o m√¥ h√¨nh Hugging Face
llm = HuggingFaceInferenceAPI(model_name="Qwen/Qwen2.5-Coder-32B-Instruct")
# T·∫°o Alfred v·ªõi t·∫•t c·∫£ c√¥ng c·ª•
alfred = AgentWorkflow.from_tools_or_functions(
    [search_tool, weather_info_tool, hub_stats_tool],
    llm=llm
)

# Truy v·∫•n m·∫´u Alfred c√≥ th·ªÉ nh·∫≠n trong bu·ªïi ti·ªác
response = await alfred.run("What is Facebook and what's their most popular model?")

print("üé© Alfred's Response:")
print(response)
```

K·∫øt qu·∫£ mong ƒë·ª£i: 

```
üé© Alfred's Response:
Facebook is a social networking service and technology company based in Menlo Park, California. It was founded by Mark Zuckerberg and allows people to create profiles, connect with friends and family, share photos and videos, and join groups based on shared interests. The most popular model by Facebook on the Hugging Face Hub is `facebook/esmfold_v1` with 13,109,861 downloads.
```

</hfoption>
<hfoption id="langgraph">

```python
from typing import TypedDict, Annotated
from langgraph.graph.message import add_messages
from langchain_core.messages import AnyMessage, HumanMessage, AIMessage
from langgraph.prebuilt import ToolNode
from langgraph.graph import START, StateGraph
from langgraph.prebuilt import tools_condition
from langchain_huggingface import HuggingFaceEndpoint, ChatHuggingFace

# T·∫°o giao di·ªán chat, bao g·ªìm c√°c c√¥ng c·ª•
llm = HuggingFaceEndpoint(
    repo_id="Qwen/Qwen2.5-Coder-32B-Instruct",
    huggingfacehub_api_token=HUGGINGFACEHUB_API_TOKEN,
)

chat = ChatHuggingFace(llm=llm, verbose=True)
tools = [search_tool, weather_info_tool, hub_stats_tool]
chat_with_tools = chat.bind_tools(tools)

# T·∫°o AgentState v√† ƒë·ªì th·ªã Agent
class AgentState(TypedDict):
    messages: Annotated[list[AnyMessage], add_messages]

def assistant(state: AgentState):
    return {
        "messages": [chat_with_tools.invoke(state["messages"])],
    }

## ƒê·ªì th·ªã
builder = StateGraph(AgentState)

# ƒê·ªãnh nghƒ©a n√∫t: th·ª±c hi·ªán c√¥ng vi·ªác
builder.add_node("assistant", assistant)
builder.add_node("tools", ToolNode(tools))

# ƒê·ªãnh nghƒ©a c·∫°nh: x√°c ƒë·ªãnh lu·ªìng ƒëi·ªÅu khi·ªÉn
builder.add_edge(START, "assistant")
builder.add_conditional_edges(
    "assistant",
    # N·∫øu tin nh·∫Øn m·ªõi nh·∫•t y√™u c·∫ßu c√¥ng c·ª•, chuy·ªÉn ƒë·∫øn tools
    # Ng∆∞·ª£c l·∫°i, tr·∫£ l·ªùi tr·ª±c ti·∫øp
    tools_condition,
)
builder.add_edge("tools", "assistant")
alfred = builder.compile()

messages = [HumanMessage(content="Who is Facebook and what's their most popular model?")]
response = alfred.invoke({"messages": messages})

print("üé© Alfred's Response:")
print(response['messages'][-1].content)
```

K·∫øt qu·∫£ mong ƒë·ª£i:

```
üé© Alfred's Response:
Facebook is a social media company known for its social networking site, Facebook, as well as other services like Instagram and WhatsApp. The most downloaded model by Facebook on the Hugging Face Hub is facebook/esmfold_v1 with 13,202,321 downloads.
```
</hfoption>
</hfoptions>

## K·∫øt lu·∫≠n

B·∫±ng c√°ch t√≠ch h·ª£p c√°c c√¥ng c·ª• n√†y, Alfred gi·ªù ƒë√£ ƒë∆∞·ª£c trang b·ªã ƒë·ªÉ x·ª≠ l√Ω nhi·ªÅu t√°c v·ª• ƒëa d·∫°ng, t·ª´ t√¨m ki·∫øm web ƒë·∫øn c·∫≠p nh·∫≠t th·ªùi ti·∫øt v√† th·ªëng k√™ m√¥ h√¨nh. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o anh ·∫•y lu√¥n l√†