# 🔧 دليل الهاردوير التفصيلي

## 📦 قائمة المكونات الكاملة

### المكونات الأساسية

| المكون | الكمية | الوصف | السعر التقريبي |
|--------|--------|-------|----------------|
| ESP32-S3-DevKitC-1 | 1 | لوحة تطوير ESP32-S3 | $10-15 |
| INMP441 | 1 | ميكروفون I2S MEMS | $2-3 |
| أسلاك Dupont | 5 | أسلاك توصيل أنثى-أنثى | $1 |
| كابل USB-C | 1 | للبرمجة والطاقة | $2 |

### المكونات الاختيارية

| المكون | الكمية | الوصف | السعر التقريبي |
|--------|--------|-------|----------------|
| LED | 1 | أي لون (أحمر، أخضر، أزرق) | $0.10 |
| مقاومة 220Ω | 1 | لحماية LED | $0.05 |
| Breadboard | 1 | لوحة تجارب | $2 |
| زر Push Button | 1 | للتحكم اليدوي | $0.20 |

## 🔌 التوصيلات التفصيلية

### INMP441 Pinout

```
INMP441 Module
┌─────────────┐
│   ●  ●  ●  │  ← Mounting holes
│             │
│   [MEMS]    │  ← Microphone sensor
│             │
└─┬─┬─┬─┬─┬──┘
  │ │ │ │ │
  │ │ │ │ └─── SD (Serial Data)
  │ │ │ └───── WS (Word Select / L/R)
  │ │ └─────── SCK (Serial Clock / BCLK)
  │ └───────── GND (Ground)
  └─────────── VDD (3.3V Power)
```

### ESP32-S3 Pinout (الدبابيس المستخدمة)

```
ESP32-S3-DevKitC-1
                    ┌─────────┐
                    │   USB   │
                    └────┬────┘
                         │
    ┌────────────────────┴────────────────────┐
    │                                         │
    │  3V3 ●                           ● GND │
    │  EN  ●                           ● IO46│
    │  IO4 ●  ← I2S DATA IN            ● IO45│
    │  IO5 ●  ← I2S WS                 ● IO0 │
    │  IO6 ●                           ● IO35│
    │  ...                             ...    │
    │  IO2 ●  ← LED                    ...    │
    │  ...                             ...    │
    │  IO18●  ← I2S BCK                ...    │
    │  ...                             ...    │
    │  GND ●                           ● GND │
    └─────────────────────────────────────────┘
```

## 🔧 خطوات التوصيل

### الخطوة 1: تحضير المكونات

1. **افحص INMP441:**
   - تأكد من عدم وجود تلف في الدبابيس
   - تحقق من نظافة الميكروفون (لا غبار)

2. **افحص ESP32-S3:**
   - تأكد من أن اللوحة تعمل (وصلها بالكمبيوتر)
   - تحقق من ظهور منفذ COM/ttyUSB

### الخطوة 2: توصيل الطاقة والأرضي

```
INMP441 VCC (3.3V) ──────► ESP32-S3 3V3
INMP441 GND        ──────► ESP32-S3 GND
```

⚠️ **تحذير مهم:** 
- استخدم **3.3V فقط** - لا تستخدم 5V!
- 5V سيتلف INMP441 بشكل دائم

### الخطوة 3: توصيل إشارات I2S

```
INMP441 SCK (BCLK) ──────► ESP32-S3 GPIO18
INMP441 WS (L/R)   ──────► ESP32-S3 GPIO5
INMP441 SD (DATA)  ──────► ESP32-S3 GPIO4
```

### الخطوة 4: توصيل LED (اختياري)

```
ESP32-S3 GPIO2 ──► [220Ω Resistor] ──► LED Anode (+)
LED Cathode (-) ──────────────────────► ESP32-S3 GND
```

**تحديد أطراف LED:**
- الطرف الأطول = Anode (+)
- الطرف الأقصر = Cathode (-)

## 📸 صور التوصيل

### التوصيل على Breadboard

```
                    ESP32-S3
                    ┌──────┐
                    │ USB  │
                    └──┬───┘
                       │
    ┌──────────────────┴──────────────────┐
    │                                     │
    │  3V3 ●─────────────────┐            │
    │  GND ●─────────┐       │            │
    │  IO4 ●───┐     │       │            │
    │  IO5 ●─┐ │     │       │            │
    │  IO18●┐│ │     │       │            │
    │  IO2 ●││ │     │       │            │
    └───────┼┼─┼─────┼───────┼────────────┘
            │││ │     │       │
            │││ │     │       │
    ┌───────┼┼┼─┼─────┼───────┼────────────┐
    │       │││ │     │       │            │
    │  SCK ●┘││ │     │       │  INMP441   │
    │  WS  ●─┘│ │     │       │            │
    │  SD   ●──┘ │     │       │            │
    │  GND  ●────┘     │       │            │
    │  VCC  ●──────────┘       │            │
    └──────────────────────────┴────────────┘

    ┌────────────────────────────────────────┐
    │         Breadboard (optional)          │
    │                                        │
    │  GPIO2 ──► [220Ω] ──► LED+ ──► LED-   │
    │                                  │     │
    │                                 GND    │
    └────────────────────────────────────────┘
```

## 🧪 اختبار التوصيلات

### اختبار 1: فحص الطاقة

```bash
# استخدم مقياس متعدد (Multimeter)
# قس الجهد بين VCC و GND على INMP441
# يجب أن يكون: 3.3V (±0.1V)
```

### اختبار 2: فحص الاتصال

```bash
# استخدم وضع الاستمرارية (Continuity) في المقياس
# تحقق من كل توصيلة:

ESP32 GPIO18 ←→ INMP441 SCK  ✓
ESP32 GPIO5  ←→ INMP441 WS   ✓
ESP32 GPIO4  ←→ INMP441 SD   ✓
ESP32 3V3    ←→ INMP441 VCC  ✓
ESP32 GND    ←→ INMP441 GND  ✓
```

### اختبار 3: فحص LED

```bash
# ارفع برنامج بسيط لتشغيل LED:
# يجب أن يضيء LED عند تشغيل GPIO2
```

## 🔍 استكشاف الأخطاء

### المشكلة: INMP441 لا يعمل

**الأعراض:**
- لا توجد قراءات صوتية
- القراءات كلها أصفار

**الحلول:**

1. **فحص الطاقة:**
   ```
   ✓ تأكد من 3.3V على VCC
   ✓ تأكد من GND متصل
   ✗ لا تستخدم 5V أبدًا!
   ```

2. **فحص L/R (WS):**
   ```
   جرب توصيل L/R إلى:
   - GND (قناة يسرى)
   - VCC (قناة يمنى)
   - GPIO5 (يتحكم البرنامج)
   ```

3. **فحص الدبابيس:**
   ```c
   // تأكد من الدبابيس في الكود:
   #define I2S_BCK_PIN     18  // ✓
   #define I2S_WS_PIN      5   // ✓
   #define I2S_DATA_IN_PIN 4   // ✓
   ```

### المشكلة: LED لا يضيء

**الحلول:**

1. **فحص الاتجاه:**
   ```
   LED Anode (+) ──► الطرف الأطول ──► GPIO2
   LED Cathode (-) ─► الطرف الأقصر ─► GND
   ```

2. **فحص المقاومة:**
   ```
   استخدم 220Ω - 1kΩ
   بدون مقاومة = LED قد يحترق!
   ```

3. **اختبار مباشر:**
   ```
   وصل LED مباشرة بين 3.3V و GND (مع مقاومة)
   إذا أضاء = LED سليم
   إذا لم يضئ = LED تالف
   ```

## 📐 مخططات بديلة

### البديل 1: استخدام دبابيس I2S مختلفة

```c
// يمكنك استخدام أي GPIO متاح:
#define I2S_BCK_PIN     16  // بدلاً من 18
#define I2S_WS_PIN      17  // بدلاً من 5
#define I2S_DATA_IN_PIN 15  // بدلاً من 4
```

⚠️ **تجنب الدبابيس:**
- GPIO0: يستخدم للبوت
- GPIO46: Strapping pin
- GPIO45: Strapping pin

### البديل 2: استخدام ميكروفونين (Stereo)

```
INMP441 #1 (Left)          ESP32-S3
┌─────────┐                ┌─────────┐
│ VCC     ├────────────────┤ 3.3V    │
│ GND     ├────────────────┤ GND     │
│ SCK     ├────────────────┤ GPIO18  │
│ WS      ├────────────────┤ GPIO5   │
│ SD      ├────────────────┤ GPIO4   │
└─────────┘                └─────────┘

INMP441 #2 (Right)
┌─────────┐
│ VCC     ├────────────────┤ 3.3V    │
│ GND     ├────────────────┤ GND     │
│ SCK     ├────────────────┤ GPIO18  │ (مشترك)
│ WS      ├────────────────┤ GPIO5   │ (مشترك)
│ SD      ├────────────────┤ GPIO19  │ (منفصل)
└─────────┘
```

## 🛠️ أدوات مفيدة

### للتطوير:
- **Multimeter**: لفحص الجهد والاتصال
- **Logic Analyzer**: لفحص إشارات I2S
- **Oscilloscope**: لفحص جودة الإشارة (متقدم)

### للتثبيت:
- **Soldering Iron**: للحام الدائم
- **Heat Shrink Tubing**: لعزل التوصيلات
- **Cable Ties**: لتنظيم الأسلاك

## 📚 مراجع إضافية

- [INMP441 Datasheet](https://invensense.tdk.com/wp-content/uploads/2015/02/INMP441.pdf)
- [ESP32-S3 Datasheet](https://www.espressif.com/sites/default/files/documentation/esp32-s3_datasheet_en.pdf)
- [I2S Protocol Specification](https://www.sparkfun.com/datasheets/BreakoutBoards/I2SBUS.pdf)

---

**نصيحة أخيرة:** خذ وقتك في التوصيل وتحقق من كل توصيلة مرتين قبل تشغيل الطاقة! 🔌✨
