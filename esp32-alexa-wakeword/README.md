# ๐ค ESP32-S3 Alexa Wake Word Detector

ูุดุฑูุน ุจุณูุท ูุงุฎุชุจุงุฑ ูููุฉ ุงูุชูุจูู "Alexa" ุนูู ESP32-S3 ุจุงุณุชุฎุฏุงู ูููุฑูููู INMP441 (I2S) ูููุชุจุงุช ESP-SR.

## ๐ ุงููุชุทูุจุงุช

### ุงููุงุฑุฏููุฑ
- **ESP32-S3** Development Board (ูุน USB)
- **INMP441** I2S MEMS Microphone
- ุฃุณูุงู ุชูุตูู (Dupont wires)
- LED (ุงุฎุชูุงุฑู) + ููุงููุฉ 220ฮฉ
- ูุงุจู USB ููุจุฑูุฌุฉ ูุงูุทุงูุฉ

### ุงูุจุฑูุฌูุงุช
- **ESP-IDF** v5.0 ุฃู ุฃุญุฏุซ
- **Python 3.8+** (ูุชุดุบูู ุงูุณูุฑุจุชุงุช)
- **VSCode** ูุน ุงูุชุฏุงุฏ Espressif IDF (ุงุฎุชูุงุฑู)

## ๐ ุชูุตูู ุงููุงุฑุฏููุฑ

### INMP441 โ ESP32-S3

| INMP441 Pin | ESP32-S3 Pin | ุงููุตู |
|-------------|--------------|-------|
| VCC         | 3.3V         | ูุตุฏุฑ ุงูุทุงูุฉ |
| GND         | GND          | ุงูุฃุฑุถู |
| SCK (BCLK)  | GPIO18       | I2S Bit Clock |
| L/R (WS)    | GPIO5        | I2S Word Select |
| SD (DATA)   | GPIO4        | I2S Data Input |

### LED (ุงุฎุชูุงุฑู)

| LED Pin | ESP32-S3 Pin | ุงููุตู |
|---------|--------------|-------|
| Anode (+) | GPIO2 โ 220ฮฉ โ LED | ุฅุดุงุฑุฉ ุจุตุฑูุฉ |
| Cathode (-) | GND | ุงูุฃุฑุถู |

### ูุฎุทุท ุงูุชูุตูู

```
ESP32-S3                    INMP441
โโโโโโโโโโโ                โโโโโโโโโโโ
โ         โ                โ         โ
โ  3.3V   โโโโโโโโโโโโโโโโโโค  VCC    โ
โ  GND    โโโโโโโโโโโโโโโโโโค  GND    โ
โ  GPIO18 โโโโโโโโโโโโโโโโโโค  SCK    โ
โ  GPIO5  โโโโโโโโโโโโโโโโโโค  L/R    โ
โ  GPIO4  โโโโโโโโโโโโโโโโโโค  SD     โ
โ         โ                โ         โ
โ  GPIO2  โโโโ[220ฮฉ]โโโLED โ         โ
โโโโโโโโโโโ                โโโโโโโโโโโ
```

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### 1. ุชุซุจูุช ESP-IDF

```bash
# ุงุณุชูุณุงุฎ ESP-IDF
git clone -b v5.1 --recursive https://github.com/espressif/esp-idf.git
cd esp-idf
./install.sh esp32s3

# ุชูุนูู ุงูุจูุฆุฉ
. ./export.sh
```

### 2. ุงุณุชูุณุงุฎ ุงููุดุฑูุน

```bash
cd ~/projects
git clone <your-repo-url> esp32-alexa-wakeword
cd esp32-alexa-wakeword
```

### 3. ุฅุถุงูุฉ ููุชุจุฉ ESP-SR (ุงุฎุชูุงุฑู - ูููุดู ุงูุญูููู)

```bash
# ุงุณุชูุณุงุฎ ESP-SR ูู ูุฌูุฏ components
cd components
git clone https://github.com/espressif/esp-sr.git
cd ..
```

> **ููุงุญุธุฉ:** ุงููุดุฑูุน ูุนูู ุจุฏูู ESP-SR ุจุงุณุชุฎุฏุงู ูุงุดู ุจุณูุท ูุนุชูุฏ ุนูู ูุณุชูู ุงูุตูุช. ูุงุณุชุฎุฏุงู ุงููุดู ุงูุญูููู ุนู "Alexa"ุ ูุฌุจ ุฅุถุงูุฉ ESP-SR.

### 4. ุชูููู ุงููุดุฑูุน

```bash
# ุชุนููู ุงููุฏู ุฅูู ESP32-S3
idf.py set-target esp32s3

# ูุชุญ ูุงุฆูุฉ ุงูุชูููู (ุงุฎุชูุงุฑู)
idf.py menuconfig
```

ูู `menuconfig`ุ ุชุญูู ูู:
- **Component config โ I2S**: Sample rate = 16000 Hz
- **Component config โ ESP32S3-Specific**: ุชูุนูู PSRAM ุฅุฐุง ูุงู ูุชุงุญูุง

### 5. ุงูุจูุงุก ูุงูุฑูุน

#### ุงูุทุฑููุฉ ุงูุฃููู: ุงุณุชุฎุฏุงู ุงูุณูุฑุจุช

```bash
# ุงุณุชุฎุฏู ุงูุณูุฑุจุช ุงููุณุงุนุฏ (Linux/Mac)
./tools/flash_and_monitor.sh /dev/ttyUSB0

# ุฃู ุนูู Windows
./tools/flash_and_monitor.sh COM3
```

#### ุงูุทุฑููุฉ ุงูุซุงููุฉ: ุงูุฃูุงูุฑ ุงููุฏููุฉ

```bash
# ุจูุงุก ุงููุดุฑูุน
idf.py build

# ุฑูุน ุนูู ุงูููุญุฉ (ุบููุฑ ุงููููุฐ ุญุณุจ ูุธุงูู)
idf.py -p /dev/ttyUSB0 flash

# ูุชุญ ุงูููููุชูุฑ ุงูุชุณูุณูู
idf.py -p /dev/ttyUSB0 monitor
```

> **ููุฎุฑูุฌ ูู ุงูููููุชูุฑ:** ุงุถุบุท `Ctrl + ]`

## ๐ ุงูุงุณุชุฎุฏุงู

### ุจุนุฏ ุฑูุน ุงูุจุฑูุงูุฌ

1. ุงูุชุญ ุงูููููุชูุฑ ุงูุชุณูุณูู (`idf.py monitor`)
2. ุณุชุธูุฑ ูุนูููุงุช ุงููุธุงู ูุงูุชูููู
3. ูู **"Alexa"** ุฃูุงู ุงููููุฑูููู
4. ุนูุฏ ุงููุดู:
   - ุณูุทุจุน ุฑุณุงูุฉ ูู ุงูููููุชูุฑ: `๐ค WAKE WORD 'ALEXA' DETECTED!`
   - ุณูููุถ LED 3 ูุฑุงุช (ุฅุฐุง ูุงู ูุชุตูุงู)

### ูุซุงู ุนูู ุงูุฅุฎุฑุงุฌ

```
I (1234) MAIN: โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
I (1235) MAIN:   ESP32-S3 Alexa Wake Word Detector
I (1236) MAIN: โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
I (1237) MAIN: Chip: esp32s3
I (1238) MAIN: Free heap: 327680 bytes
I (1239) MAIN: 
I (1240) MAIN: Hardware Configuration:
I (1241) MAIN:   Microphone: INMP441 (I2S)
I (1242) MAIN:   Sample Rate: 16000 Hz
I (1243) MAIN:   Bits per Sample: 16
I (1244) MAIN:   Channels: Mono
I (1245) MAIN: 
I (1246) MAIN: Pin Configuration:
I (1247) MAIN:   I2S_BCK  (SCK): GPIO18
I (1248) MAIN:   I2S_WS   (L/R): GPIO5
I (1249) MAIN:   I2S_DATA (SD):  GPIO4
I (1250) MAIN:   LED:            GPIO2
I (1251) MAIN: โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
I (1252) MAIN: โ NVS initialized
I (1253) I2S_CONFIG: Initializing I2S for INMP441 microphone
I (1254) I2S_CONFIG: I2S initialized successfully - Sample Rate: 16000 Hz
I (1255) MAIN: โ I2S initialized
I (1256) WAKE_WORD: Initializing Wake Word Detector
I (1257) WAKE_WORD: LED configured on GPIO 2
I (1258) MAIN: โ Wake word detector initialized
I (1259) MAIN: 
I (1260) MAIN: ๐ค System ready! Say 'Alexa' to test...
I (1261) MAIN: 
I (5678) WAKE_WORD: โ๏ธ  SIMULATED WAKE WORD DETECTED (high audio energy)
I (5679) WAKE_WORD: ๐ค ALEXA WAKE WORD TRIGGERED!
I (5680) MAIN: โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
I (5681) MAIN: ๐ค WAKE WORD 'ALEXA' DETECTED!
I (5682) MAIN: โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ง ุงูุชูููู ุงููุชูุฏู

### ุชุบููุฑ ุฏุจุงุจูุณ I2S

ุนุฏูู ุงูููู `main/i2s_config.h`:

```c
#define I2S_BCK_PIN     18  // ุบููุฑ ุฅูู ุงูุฏุจูุณ ุงููุทููุจ
#define I2S_WS_PIN      5
#define I2S_DATA_IN_PIN 4
```

### ุชุบููุฑ ูุนุฏู ุงูุนููุงุช

ุนุฏูู ูู `main/i2s_config.h`:

```c
#define SAMPLE_RATE     16000  // 8000, 16000, 44100, ุฅูุฎ
```

### ุชุบููุฑ ุฏุจูุณ LED

ุนุฏูู ูู `main/wake_word_detector.h`:

```c
#define LED_PIN 2  // ุบููุฑ ุฅูู ุงูุฏุจูุณ ุงููุทููุจ
```

## ๐งช ุงุณุชุฎุฏุงู ESP-SR ูููุดู ุงูุญูููู

### 1. ุฅุถุงูุฉ ESP-SR

```bash
cd components
git clone https://github.com/espressif/esp-sr.git
cd ..
```

### 2. ุชูุนูู ุงูููุฏ ูู ุงููููุงุช

ูู `main/wake_word_detector.c`ุ ุฃุฒู ุงูุชุนูููุงุช ูู:
- `#include` statements ูู ESP-SR
- ููุฏ ุงูุชููุฆุฉ ูู `wake_word_detector_init()`
- ููุฏ ุงููุดู ูู `wake_word_detect()`

### 3. ุชูููู ุงูููุฏูู

```bash
# ูู menuconfig
idf.py menuconfig

# ุงุฐูุจ ุฅูู:
# Component config โ ESP Speech Recognition
# - ุงุฎุชุฑ WakeNet model (ูุซู WakeNet9)
# - ุงุฎุชุฑ wake word (Alexa)
```

### 4. ุชุฌููุน ุงูููุฏูู (ุฅุฐุง ูุฒู ุงูุฃูุฑ)

```bash
cd components/esp-sr/model
python pack_model.py -m wakenet9 -o srmodels.bin
```

ุฃู ุงุณุชุฎุฏู ุงูุณูุฑุจุช ุงููุฑูู:

```bash
python tools/pack_model.py -m components/esp-sr/model/wakenet9 -o srmodels.bin
```

### 5. ุฅุนุงุฏุฉ ุงูุจูุงุก ูุงูุฑูุน

```bash
idf.py build
idf.py -p /dev/ttyUSB0 flash monitor
```

## ๐ ุญู ุงููุดุงูู

### ุงููุดููุฉ: ูุง ููุฑุฃ ุงููููุฑูููู ุฃู ุตูุช

**ุงูุญููู:**
1. ุชุญูู ูู ุงูุชูุตููุงุช (ุฎุงุตุฉ VCC โ 3.3V ูููุณ 5V)
2. ุชุฃูุฏ ูู ุฃู ุฏุจุงุจูุณ I2S ุตุญูุญุฉ ูู ุงูููุฏ
3. ุฌุฑุจ ุนูุณ L/R (ูุตูู ุจู GND ุฃู VCC)
4. ุชุญูู ูู ููุฌุงุช I2S ูู ุงูููููุชูุฑ

### ุงููุดููุฉ: ุฎุทุฃ ูู ุงูุจูุงุก - ESP-SR not found

**ุงูุญู:**
```bash
# ุชุฃูุฏ ูู ูุฌูุฏ ESP-SR ูู components
ls components/esp-sr

# ุฅุฐุง ูู ููู ููุฌูุฏูุงุ ุงุณุชูุณุฎู
cd components
git clone https://github.com/espressif/esp-sr.git
```

### ุงููุดููุฉ: ุงููุดู ุงูุฎุงุทุฆ (False Positives)

**ุงูุญููู:**
1. ุงุถุจุท threshold ูู `wake_word_detect()`
2. ุงุณุชุฎุฏู ููุฏูู ESP-SR ุงูุญูููู ุจุฏูุงู ูู ุงููุงุดู ุงูุจุณูุท
3. ููู ุงูุถูุถุงุก ุงููุญูุทุฉ
4. ุชุฃูุฏ ูู ุฌูุฏุฉ ุงููููุฑูููู

### ุงููุดููุฉ: ุฎุทุฃ ูู ุงูููุงุด - Not enough space

**ุงูุญููู:**
```bash
# ูู menuconfig
idf.py menuconfig

# ุงุฐูุจ ุฅูู:
# Partition Table โ Partition Table โ Custom partition table CSV
# ุฃู ุงุณุชุฎุฏู partition table ุฃูุจุฑ
```

### ุงููุดููุฉ: ุงููููุฑูููู ูุนุทู ูุฑุงุกุงุช ุตูุฑูุฉ

**ุงูุญููู:**
1. ุชุญูู ูู ุฃู INMP441 ูุนูู (ูุณ ุงูุฌูุฏ ุนูู VCC)
2. ุฌุฑุจ ุฏุจุงุจูุณ I2S ูุฎุชููุฉ
3. ุชุฃูุฏ ูู ุฃู L/R ูุชุตู (GND = ููุงุฉ ูุณุฑูุ VCC = ููุงุฉ ูููู)
4. ุฃุถู ุชุฃุฎูุฑ ุจุนุฏ ุชููุฆุฉ I2S: `vTaskDelay(pdMS_TO_TICKS(100));`

## ๐ ูููู ุงููุดุฑูุน

```
esp32-alexa-wakeword/
โโโ CMakeLists.txt              # ุชูููู CMake ุงูุฑุฆูุณู
โโโ sdkconfig.defaults          # ุฅุนุฏุงุฏุงุช SDK ุงูุงูุชุฑุงุถูุฉ
โโโ README.md                   # ูุฐุง ุงูููู
โโโ main/
โ   โโโ CMakeLists.txt          # ุชูููู ุงููููู ุงูุฑุฆูุณู
โ   โโโ main.c                  # ุงูุจุฑูุงูุฌ ุงูุฑุฆูุณู
โ   โโโ i2s_config.h            # ุชุนุฑููุงุช I2S
โ   โโโ i2s_config.c            # ุชุทุจูู I2S
โ   โโโ wake_word_detector.h    # ุชุนุฑููุงุช ูุงุดู wake word
โ   โโโ wake_word_detector.c    # ุชุทุจูู ุงููุงุดู
โโโ components/
โ   โโโ esp-sr/                 # ููุชุจุฉ ESP-SR (ูุฌุจ ุงุณุชูุณุงุฎูุง)
โโโ tools/
    โโโ pack_model.py           # ุณูุฑุจุช ุชุฌููุน ุงูููุฏููุงุช
    โโโ flash_and_monitor.sh    # ุณูุฑุจุช ุงูุจูุงุก ูุงูุฑูุน
```

## ๐ ุงูุฃูุงูุฑ ุงููููุฏุฉ

```bash
# ุจูุงุก ุงููุดุฑูุน ููุท
idf.py build

# ูุณุญ ุงูุจูุงุก ุงูุณุงุจู
idf.py fullclean

# ุฑูุน ุจุฏูู ุจูุงุก
idf.py -p /dev/ttyUSB0 flash

# ููููุชูุฑ ููุท
idf.py -p /dev/ttyUSB0 monitor

# ุจูุงุก + ุฑูุน + ููููุชูุฑ
idf.py -p /dev/ttyUSB0 flash monitor

# ุนุฑุถ ุญุฌู ุงูุจุฑูุงูุฌ
idf.py size

# ุนุฑุถ ูุนูููุงุช ุงูู partition
idf.py partition-table
```

## ๐ ุงููุฑุงุฌุน

- [ESP-IDF Documentation](https://docs.espressif.com/projects/esp-idf/en/latest/)
- [ESP-SR GitHub](https://github.com/espressif/esp-sr)
- [INMP441 Datasheet](https://invensense.tdk.com/products/digital/inmp441/)
- [ESP32-S3 Technical Reference](https://www.espressif.com/sites/default/files/documentation/esp32-s3_technical_reference_manual_en.pdf)

## ๐ค ุงููุณุงููุฉ

ุงููุณุงููุงุช ูุฑุญุจ ุจูุง! ูุฑุฌู:
1. Fork ุงููุดุฑูุน
2. ุฅูุดุงุก branch ููููุฒุฉ (`git checkout -b feature/amazing-feature`)
3. Commit ุงูุชุบููุฑุงุช (`git commit -m 'Add amazing feature'`)
4. Push ุฅูู Branch (`git push origin feature/amazing-feature`)
5. ูุชุญ Pull Request

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ูุฑุฎุต ุชุญุช MIT License - ุงูุธุฑ ููู LICENSE ููุชูุงุตูู.

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ุงููุงุดู ุงูุญุงูู ุจุณูุท**: ูุนุชูุฏ ุนูู ูุณุชูู ุงูุทุงูุฉ ุงูุตูุชูุฉ ููุท. ูููุดู ุงูุญูููู ุนู "Alexa"ุ ุงุณุชุฎุฏู ESP-SR.

2. **ุงุณุชููุงู ุงูุทุงูุฉ**: ุงููุดุฑูุน ูุณุชููู ุทุงูุฉ ูุชูุณุทุฉ. ููุชุทุจููุงุช ุงูุชู ุชุนูู ุจุงูุจุทุงุฑูุฉุ ููุฑ ูู:
   - ุงุณุชุฎุฏุงู Deep Sleep ุจูู ุงููุดููุงุช
   - ุชูููู ูุนุฏู ุงูุนููุงุช
   - ุชุญุณูู ุฎูุงุฑุฒููุฉ ุงููุดู

3. **ุงูุฎุตูุตูุฉ**: ุงููุดู ูุชู ูุญูููุง ุนูู ESP32-S3 ุจุฏูู ุฅุฑุณุงู ุจูุงูุงุช ููุฅูุชุฑูุช.

4. **ุงูุฃุฏุงุก**: ESP32-S3 ููู ุจูุง ูููู ูููุดู ูู ุงูููุช ุงููุนูู ูุน ูุนุฏู ุนููุงุช 16kHz.

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

- [ ] ุฅุถุงูุฉ ุฏุนู ูููุงุช ุชูุจูู ูุชุนุฏุฏุฉ
- [ ] ุชุญุณูู ุฏูุฉ ุงููุดู
- [ ] ุฅุถุงูุฉ ูุงุฌูุฉ ููุจ ููุชุญูู
- [ ] ุฏุนู ุงูุจููุชูุซ ููุชุญูู ุนู ุจุนุฏ
- [ ] ุฅุถุงูุฉ ุชุณุฌูู ุงูุตูุช ุจุนุฏ ุงููุดู
- [ ] ุฏูุฌ ูุน ุฎุฏูุงุช ุณุญุงุจูุฉ (AWS Alexa, Google Assistant)

## ๐ง ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ูุดุงูู:
1. ุชุญูู ูู ูุณู [ุญู ุงููุดุงูู](#-ุญู-ุงููุดุงูู)
2. ุงุจุญุซ ูู [Issues](https://github.com/your-repo/issues)
3. ุงูุชุญ Issue ุฌุฏูุฏ ูุน:
   - ูุตู ุงููุดููุฉ
   - ููุฌุงุช ุงูููููุชูุฑ ุงูุชุณูุณูู
   - ูุนูููุงุช ุงููุงุฑุฏููุฑ ูุงูุจุฑูุฌูุงุช

---

**ุตููุน ุจู โค๏ธ ูููุฌุชูุน ุงูุนุฑุจู**

๐ ุฅุฐุง ุฃุนุฌุจู ุงููุดุฑูุนุ ูุง ุชูุณู ุฅุนุทุงุกู ูุฌูุฉ ุนูู GitHub!
